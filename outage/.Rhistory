mean_increase <- diff(a) > 0
rle_ <- rle(mean_increase)
rle_true <- rle_$lengths * rle_$values
index <- match(max(rle_true), rle_$lengths)
outage_a <- cumsum(rle_$lengths)[index] - max(rle_true) + 1 + window_size
outage_a
a <- rollapply(data$value, width = window_size, by = 1, FUN = mean)
mean_increase <- diff(a) < 0
rle_ <- rle(mean_increase)
rle_true <- rle_$lengths * rle_$values
index <- match(max(rle_true), rle_$lengths)
outage_b <- cumsum(rle_$lengths)[index] - max(rle_true) + 1 + window_size
outage_b
plot(data$transactiondate, data$value)
abline(v=outage_a, col="red")
abline(v=outage_b, col="red")
window_size <- 100
a <- rollapply(data$value, width = window_size, by = 1, FUN = mean)
mean_increase <- diff(a) > 0
rle_ <- rle(mean_increase)
rle_true <- rle_$lengths * rle_$values
index <- match(max(rle_true), rle_$lengths)
outage_a <- cumsum(rle_$lengths)[index] - max(rle_true) + 1 - window_size
a <- rollapply(data$value, width = window_size, by = 1, FUN = mean)
mean_increase <- diff(a) < 0
rle_ <- rle(mean_increase)
rle_true <- rle_$lengths * rle_$values
index <- match(max(rle_true), rle_$lengths)
outage_b <- cumsum(rle_$lengths)[index] - max(rle_true) + 1 - window_size
plot(data$transactiondate, data$value)
abline(v=outage_a, col="red")
abline(v=outage_b, col="red")
mean(data$value[1:100])
a[1]
window_size <- 100
a <- rollapply(data$value, width = window_size, by = 1, FUN = mean)
mean_increase <- diff(a) > 0
rle_ <- rle(mean_increase)
rle_true <- rle_$lengths * rle_$values
index <- match(max(rle_true), rle_$lengths)
outage_a <- cumsum(rle_$lengths)[index] - max(rle_true) + 1 #- window_size
a <- rollapply(data$value, width = window_size, by = 1, FUN = mean)
mean_increase <- diff(a) < 0
rle_ <- rle(mean_increase)
rle_true <- rle_$lengths * rle_$values
index <- match(max(rle_true), rle_$lengths)
outage_b <- cumsum(rle_$lengths)[index] - max(rle_true) + 1 #- window_size
plot(data$transactiondate, data$value)
abline(v=outage_a, col="red")
abline(v=outage_b, col="red")
max(rle_true)
seq <-c(TRUE, FALSE, FALSE, TRUE, FALSE, TRUE, TRUE, TRUE, FALSE, FALSE, FALSE, FALSE, TRUE, TRUE, TRUE, TRUE, TRUE)
rle_ <- rle(seq)
rle_true <- rle_$lengths * rle_$values
index <- match(max(max_pos), rle_$lengths)
cumsum(rle_$lengths)[index] - max(rle_true) + 1
fake_data <- c(0.1, 0.2, 0.1, 0.3, 0.5, 0.2, 0.1, 0.05, 0.1, 0.2, 0.3, 0.4, 0.2 )
diff(fake_data>0)
diff(fake_data)>0
window_size <- 100
a <- rollapply(data$value, width = window_size, by = 1, FUN = mean)
mean_increase <- diff(a) > 0
rle_ <- rle(mean_increase)
rle_true <- rle_$lengths * rle_$values
index <- match(max(rle_true), rle_$lengths)
outage_a <- cumsum(rle_$lengths)[index] - max(rle_true) + 1 + window_size
a <- rollapply(data$value, width = window_size, by = 1, FUN = mean)
mean_increase <- diff(a) < 0
rle_ <- rle(mean_increase)
rle_true <- rle_$lengths * rle_$values
index <- match(max(rle_true), rle_$lengths)
outage_b <- cumsum(rle_$lengths)[index] - max(rle_true) + 1 + window_size
plot(data$transactiondate, data$value)
abline(v=outage_a, col="red")
abline(v=outage_b, col="red")
?rollapply
#length(t)
window_size <- 100
a <- rollapply(data$value, width = window_size, by = 1, align="left", FUN = mean)
mean_increase <- diff(a) > 0
rle_ <- rle(mean_increase)
rle_true <- rle_$lengths * rle_$values
index <- match(max(rle_true), rle_$lengths)
outage_a <- cumsum(rle_$lengths)[index] - max(rle_true) + 1 + window_size
a <- rollapply(data$value, width = window_size, by = 1, FUN = mean)
mean_increase <- diff(a) < 0
rle_ <- rle(mean_increase)
rle_true <- rle_$lengths * rle_$values
index <- match(max(rle_true), rle_$lengths)
outage_b <- cumsum(rle_$lengths)[index] - max(rle_true) + 1 + window_size
plot(data$transactiondate, data$value)
abline(v=outage_a, col="red")
abline(v=outage_b, col="red")
#length(t)
window_size <- 100
a <- rollapply(data$value, width = window_size, by = 1, align="left", FUN = mean)
mean_increase <- diff(a) > 0
rle_ <- rle(mean_increase)
rle_true <- rle_$lengths * rle_$values
index <- match(max(rle_true), rle_$lengths)
outage_a <- cumsum(rle_$lengths)[index] - max(rle_true) + 1 + window_size
a <- rollapply(data$value, width = window_size, by = 1, FUN = mean)
mean_increase <- diff(a) < 0
rle_ <- rle(mean_increase)
rle_true <- rle_$lengths * rle_$values
index <- match(max(rle_true), rle_$lengths)
outage_b <- cumsum(rle_$lengths)[index] - max(rle_true) + 1 + window_size
plot(data$transactiondate, data$value)
abline(v=outage_a, col="red")
abline(v=outage_b, col="red")
window_size <- 100
a <- rollapply(data$value, width = window_size, by = 1, align="left", FUN = mean)
mean_increase <- diff(a) > 0
rle_ <- rle(mean_increase)
rle_true <- rle_$lengths * rle_$values
index <- match(max(rle_true), rle_$lengths)
outage_a <- cumsum(rle_$lengths)[index] - max(rle_true) + 1 + window_size
a <- rollapply(data$value, width = window_size, by = 1, align="left", FUN = mean)
mean_increase <- diff(a) < 0
rle_ <- rle(mean_increase)
rle_true <- rle_$lengths * rle_$values
index <- match(max(rle_true), rle_$lengths)
outage_b <- cumsum(rle_$lengths)[index] - max(rle_true) + 1 + window_size
plot(data$transactiondate, data$value)
abline(v=outage_a, col="red")
abline(v=outage_b, col="red")
mean(data$value[1:100])
a[1]
mean(data$value[6:105])
a[6]
length(a)
length(data$value)
plot(data$transactiondate, data$value)
abline(v=5, col="red")
abline(v=outage_b, col="red")
plot(data$transactiondate, data$value)
abline(v=7362, col="red")
abline(v=outage_b, col="red")
data$value[length(data$value)]
plot(data$transactiondate, data$value)
abline(v=data$transactiondate[1], col="red")
abline(v=outage_b, col="red")
t1 <- data$transactiondate[outage_a]
t2 <- data$transactiondate[outage_b]
plot(data$transactiondate, data$value)
abline(v=t1, col="red")
abline(v=t2, col="red")
window_size <- 100
a <- rollapply(data$value, width = window_size, by = 1, align="left", FUN = mean)
mean_increase <- diff(a) > 0
rle_ <- rle(mean_increase)
rle_true <- rle_$lengths * rle_$values
index <- match(max(rle_true), rle_$lengths)
outage_a <- cumsum(rle_$lengths)[index] - max(rle_true) + 1 + window_size
a <- rollapply(data$value, width = window_size, by = 1, align="left", FUN = mean)
mean_increase <- diff(a) < 0
rle_ <- rle(mean_increase)
rle_true <- rle_$lengths * rle_$values
index <- match(max(rle_true), rle_$lengths)
outage_b <- cumsum(rle_$lengths)[index] - max(rle_true) + 1 + window_size
t1 <- data$transactiondate[outage_a]
t2 <- data$transactiondate[outage_b]
plot(data$transactiondate, data$value)
abline(v=t1, col="red")
abline(v=t2, col="red")
window_size <- 100
a <- rollapply(data$value, width = window_size, by = 1, align="left", FUN = mean)
mean_increase <- diff(a) > 0
rle_ <- rle(mean_increase)
rle_true <- rle_$lengths * rle_$values
index <- match(max(rle_true), rle_$lengths)
outage_a <- cumsum(rle_$lengths)[index] - max(rle_true) + 1 + #window_size
a <- rollapply(data$value, width = window_size, by = 1, align="left", FUN = mean)
mean_increase <- diff(a) < 0
rle_ <- rle(mean_increase)
rle_true <- rle_$lengths * rle_$values
index <- match(max(rle_true), rle_$lengths)
outage_b <- cumsum(rle_$lengths)[index] - max(rle_true) + 1 +# window_size
t1 <- data$transactiondate[outage_a]
t2 <- data$transactiondate[outage_b]
plot(data$transactiondate, data$value)
abline(v=t1, col="red")
abline(v=t2, col="red")
window_size <- 100
a <- rollapply(data$value, width = window_size, by = 1, align="left", FUN = mean)
mean_increase <- diff(a) > 0
rle_ <- rle(mean_increase)
rle_true <- rle_$lengths * rle_$values
index <- match(max(rle_true), rle_$lengths)
outage_a <- cumsum(rle_$lengths)[index] - max(rle_true) + 1 #+ window_size
a <- rollapply(data$value, width = window_size, by = 1, align="left", FUN = mean)
mean_increase <- diff(a) < 0
rle_ <- rle(mean_increase)
rle_true <- rle_$lengths * rle_$values
index <- match(max(rle_true), rle_$lengths)
outage_b <- cumsum(rle_$lengths)[index] - max(rle_true) + 1 #+ window_size
t1 <- data$transactiondate[outage_a]
t2 <- data$transactiondate[outage_b]
plot(data$transactiondate, data$value)
abline(v=t1, col="red")
abline(v=t2, col="red")
window_size <- 100
a <- rollapply(data$value, width = window_size, by = 1, align="left", FUN = mean)
mean_increase <- diff(a) > 0
rle_ <- rle(mean_increase)
rle_true <- rle_$lengths * rle_$values
index <- match(max(rle_true), rle_$lengths)
outage_a <- cumsum(rle_$lengths)[index] - max(rle_true) + 1 #+ window_size
a <- rollapply(data$value, width = window_size, by = 1, align="left", FUN = mean)
mean_increase <- diff(a) < 0
rle_ <- rle(mean_increase)
rle_true <- rle_$lengths * rle_$values
index <- match(max(rle_true), rle_$lengths)
outage_b <- cumsum(rle_$lengths)[index] - max(rle_true) + 1 #+ window_size
t1 <- data$transactiondate[outage_a]
t2 <- data$transactiondate[outage_b]
plot(data$transactiondate, data$value)
abline(v=t1, col="red")
abline(v=t2, col="red")
window_size <- 20
a <- rollapply(data$value, width = window_size, by = 1, align="left", FUN = mean)
mean_increase <- diff(a) > 0
rle_ <- rle(mean_increase)
rle_true <- rle_$lengths * rle_$values
index <- match(max(rle_true), rle_$lengths)
outage_a <- cumsum(rle_$lengths)[index] - max(rle_true) + window_size
a <- rollapply(data$value, width = window_size, by = 1, align="left", FUN = mean)
mean_increase <- diff(a) < 0
rle_ <- rle(mean_increase)
rle_true <- rle_$lengths * rle_$values
index <- match(max(rle_true), rle_$lengths)
outage_b <- cumsum(rle_$lengths)[index] - max(rle_true) + window_size
t1 <- data$transactiondate[outage_a]
t2 <- data$transactiondate[outage_b]
plot(data$transactiondate, data$value)
abline(v=t1, col="red")
abline(v=t2, col="red")
window_size <- 50
a <- rollapply(data$value, width = window_size, by = 1, align="left", FUN = mean)
mean_increase <- diff(a) > 0
rle_ <- rle(mean_increase)
rle_true <- rle_$lengths * rle_$values
index <- match(max(rle_true), rle_$lengths)
outage_a <- cumsum(rle_$lengths)[index] - max(rle_true) + window_size
a <- rollapply(data$value, width = window_size, by = 1, align="left", FUN = mean)
mean_increase <- diff(a) < 0
rle_ <- rle(mean_increase)
rle_true <- rle_$lengths * rle_$values
index <- match(max(rle_true), rle_$lengths)
outage_b <- cumsum(rle_$lengths)[index] - max(rle_true) + window_size
t1 <- data$transactiondate[outage_a]
t2 <- data$transactiondate[outage_b]
plot(data$transactiondate, data$value)
abline(v=t1, col="red")
abline(v=t2, col="red")
window_size <- 100
a <- rollapply(data$value, width = window_size, by = 1, align="left", FUN = mean)
mean_increase <- diff(a) > 0
rle_ <- rle(mean_increase)
rle_true <- rle_$lengths * rle_$values
index <- match(max(rle_true), rle_$lengths)
outage_a <- cumsum(rle_$lengths)[index] - max(rle_true) + window_size
a <- rollapply(data$value, width = window_size, by = 1, align="left", FUN = mean)
mean_increase <- diff(a) < 0
rle_ <- rle(mean_increase)
rle_true <- rle_$lengths * rle_$values
index <- match(max(rle_true), rle_$lengths)
outage_b <- cumsum(rle_$lengths)[index] - max(rle_true) + window_size
t1 <- data$transactiondate[outage_a]
t2 <- data$transactiondate[outage_b]
plot(data$transactiondate, data$value)
abline(v=t1, col="red")
abline(v=t2, col="red")
window_size <- 50
a <- rollapply(data$value, width = window_size, by = 1, align="left", FUN = mean)
mean_increase <- diff(a) > 0
rle_ <- rle(mean_increase)
rle_true <- rle_$lengths * rle_$values
index <- match(max(rle_true), rle_$lengths)
outage_a <- cumsum(rle_$lengths)[index] - max(rle_true) + window_size
a <- rollapply(data$value, width = window_size, by = 1, align="left", FUN = mean)
mean_increase <- diff(a) < 0
rle_ <- rle(mean_increase)
rle_true <- rle_$lengths * rle_$values
index <- match(max(rle_true), rle_$lengths)
outage_b <- cumsum(rle_$lengths)[index] - max(rle_true) + window_size
t1 <- data$transactiondate[outage_a]
t2 <- data$transactiondate[outage_b]
plot(data$transactiondate, data$value)
abline(v=t1, col="red")
abline(v=t2, col="red")
outage_b
outage_a
mean_decrease <- diff(a) < 0
rle_ <- rle(mean_decrease)
rle_true <- rle_$lengths * rle_$values
index <- match(max(rle_true), rle_$lengths)
outage_b <- cumsum(rle_$lengths)[index] - max(rle_true) + window_size
outage_b
mean_decrease
data$value[length(data$value)]
mean_decrease[1:10]
mean_increase[1:10]
mean_decrease <- diff(a) < 0
a <- rollapply(data$value, width = window_size, by = 1, align="left", FUN = mean)
mean_increase <- diff(a) > 0
rle_ <- rle(mean_increase)
rle_true <- rle_$lengths * rle_$values
index <- match(max(rle_true), rle_$lengths)
outage_a <- cumsum(rle_$lengths)[index] - max(rle_true) + window_size
mean_increase[1:10]
mean_decrease <- diff(a) < 0
rle_ <- rle(mean_decrease)
rle_true <- rle_$lengths * rle_$values
index <- match(max(rle_true), rle_$lengths)
outage_b <- cumsum(rle_$lengths)[index] - max(rle_true) + window_size
mean_decrease[1:10]
rle(mean_decrease)
rle(mean_increase)
window_size <- 60
a <- rollapply(data$value, width = window_size, by = 1, align="left", FUN = mean)
mean_increase <- diff(a) > 0
rle_ <- rle(mean_increase)
rle_true <- rle_$lengths * rle_$values
index <- match(max(rle_true), rle_$lengths)
outage_a <- cumsum(rle_$lengths)[index] - max(rle_true) + window_size
#a <- rollapply(data$value, width = window_size, by = 1, align="left", FUN = mean)
mean_decrease <- diff(a) < 0
rle_ <- rle(mean_decrease)
rle_true <- rle_$lengths * rle_$values
index <- match(max(rle_true), rle_$lengths)
outage_b <- cumsum(rle_$lengths)[index] - max(rle_true) + window_size
t1 <- data$transactiondate[outage_a]
t2 <- data$transactiondate[outage_b]
plot(data$transactiondate, data$value)
abline(v=t1, col="red")
abline(v=t2, col="red")
window_size <- 200
a <- rollapply(data$value, width = window_size, by = 1, align="left", FUN = mean)
mean_increase <- diff(a) > 0
rle_ <- rle(mean_increase)
rle_true <- rle_$lengths * rle_$values
index <- match(max(rle_true), rle_$lengths)
outage_a <- cumsum(rle_$lengths)[index] - max(rle_true) + window_size
#a <- rollapply(data$value, width = window_size, by = 1, align="left", FUN = mean)
mean_decrease <- diff(a) < 0
rle_ <- rle(mean_decrease)
rle_true <- rle_$lengths * rle_$values
index <- match(max(rle_true), rle_$lengths)
outage_b <- cumsum(rle_$lengths)[index] - max(rle_true) + window_size
t1 <- data$transactiondate[outage_a]
t2 <- data$transactiondate[outage_b]
plot(data$transactiondate, data$value)
abline(v=t1, col="red")
abline(v=t2, col="red")
window_size <- 250
a <- rollapply(data$value, width = window_size, by = 1, align="left", FUN = mean)
mean_increase <- diff(a) > 0
rle_ <- rle(mean_increase)
rle_true <- rle_$lengths * rle_$values
index <- match(max(rle_true), rle_$lengths)
outage_a <- cumsum(rle_$lengths)[index] - max(rle_true) + window_size
#a <- rollapply(data$value, width = window_size, by = 1, align="left", FUN = mean)
mean_decrease <- diff(a) < 0
rle_ <- rle(mean_decrease)
rle_true <- rle_$lengths * rle_$values
index <- match(max(rle_true), rle_$lengths)
outage_b <- cumsum(rle_$lengths)[index] - max(rle_true) + window_size
t1 <- data$transactiondate[outage_a]
t2 <- data$transactiondate[outage_b]
plot(data$transactiondate, data$value)
abline(v=t1, col="red")
abline(v=t2, col="red")
window_size <- 100
a <- rollapply(data$value, width = window_size, by = 1, align="left", FUN = mean)
mean_increase <- diff(a) > 0
rle_ <- rle(mean_increase)
rle_true <- rle_$lengths * rle_$values
index <- match(max(rle_true), rle_$lengths)
outage_a <- cumsum(rle_$lengths)[index] - max(rle_true) + window_size
#a <- rollapply(data$value, width = window_size, by = 1, align="left", FUN = mean)
mean_decrease <- diff(a) < 0
rle_ <- rle(mean_decrease)
rle_true <- rle_$lengths * rle_$values
index <- match(max(rle_true), rle_$lengths)
outage_b <- cumsum(rle_$lengths)[index] - max(rle_true) + window_size
t1 <- data$transactiondate[outage_a]
t2 <- data$transactiondate[outage_b]
plot(data$transactiondate, data$value)
abline(v=t1, col="red")
abline(v=t2, col="red")
window_size <- 500
a <- rollapply(data$value, width = window_size, by = 1, align="left", FUN = mean)
mean_increase <- diff(a) > 0
rle_ <- rle(mean_increase)
rle_true <- rle_$lengths * rle_$values
index <- match(max(rle_true), rle_$lengths)
outage_a <- cumsum(rle_$lengths)[index] - max(rle_true) + window_size
#a <- rollapply(data$value, width = window_size, by = 1, align="left", FUN = mean)
mean_decrease <- diff(a) < 0
rle_ <- rle(mean_decrease)
rle_true <- rle_$lengths * rle_$values
index <- match(max(rle_true), rle_$lengths)
outage_b <- cumsum(rle_$lengths)[index] - max(rle_true) + window_size
t1 <- data$transactiondate[outage_a]
t2 <- data$transactiondate[outage_b]
plot(data$transactiondate, data$value)
abline(v=t1, col="red")
abline(v=t2, col="red")
window_size <- 60
a <- rollapply(data$value, width = window_size, by = 1, align="left", FUN = mean)
mean_increase <- diff(a) > 0
rle_ <- rle(mean_increase)
rle_true <- rle_$lengths * rle_$values
index <- match(max(rle_true), rle_$lengths)
outage_a <- cumsum(rle_$lengths)[index] - max(rle_true) + window_size
#a <- rollapply(data$value, width = window_size, by = 1, align="left", FUN = mean)
mean_decrease <- diff(a) < 0
rle_ <- rle(mean_decrease)
rle_true <- rle_$lengths * rle_$values
index <- match(max(rle_true), rle_$lengths)
outage_b <- cumsum(rle_$lengths)[index] - max(rle_true) + window_size
t1 <- data$transactiondate[outage_a]
t2 <- data$transactiondate[outage_b]
plot(data$transactiondate, data$value)
abline(v=t1, col="red")
abline(v=t2, col="red")
window_size <- 50
mean_value <- rollapply(data$value, width = window_size, by = 1, align="left", FUN = mean)
mean_increase <- diff(mean_value) > 0
rle_mean_inc <- rle(mean_increase)
rle_true <- rle_mean_inc$lengths * rle_mean_inc$values
index <- match(max(rle_true), rle_true$lengths)
outage_a <- cumsum(rle_mean_inc$lengths)[index] - max(rle_true) + window_size
#a <- rollapply(data$value, width = window_size, by = 1, align="left", FUN = mean)
mean_decrease <- diff(a) < 0
rle_ <- rle(mean_decrease)
rle_true <- rle_$lengths * rle_$values
index <- match(max(rle_true), rle_$lengths)
outage_b <- cumsum(rle_$lengths)[index] - max(rle_true) + window_size
t1 <- data$transactiondate[outage_a]
t2 <- data$transactiondate[outage_b]
plot(data$transactiondate, data$value)
abline(v=t1, col="red")
abline(v=t2, col="red")
window_size <- 50
mean_value <- rollapply(data$value, width = window_size, by = 1, align="left", FUN = mean)
mean_increase <- diff(mean_value) > 0
rle_mean_inc <- rle(mean_increase)
rle_true <- rle_mean_inc$lengths * rle_mean_inc$values
index <- match(max(rle_true), rle_true)
outage_a <- cumsum(rle_mean_inc$lengths)[index] - max(rle_true) + window_size
#a <- rollapply(data$value, width = window_size, by = 1, align="left", FUN = mean)
mean_decrease <- diff(a) < 0
rle_ <- rle(mean_decrease)
rle_true <- rle_$lengths * rle_$values
index <- match(max(rle_true), rle_$lengths)
outage_b <- cumsum(rle_$lengths)[index] - max(rle_true) + window_size
t1 <- data$transactiondate[outage_a]
t2 <- data$transactiondate[outage_b]
plot(data$transactiondate, data$value)
abline(v=t1, col="red")
abline(v=t2, col="red")
window_size <- 50
mean_value <- rollapply(data$value, width = window_size, by = 1, align="left", FUN = mean)
mean_increase <- diff(mean_value) > 0
rle_mean_inc <- rle(mean_increase)
rle_true <- rle_mean_inc$lengths * rle_mean_inc$values
index <- match(max(rle_true), rle_true)
outage_a <- cumsum(rle_mean_inc$lengths)[index] - max(rle_true) + window_size
#a <- rollapply(data$value, width = window_size, by = 1, align="left", FUN = mean)
mean_decrease <- diff(a) < 0
rle_mean_dec <- rle(mean_decrease)
rle_true <- rle_mean_dec$lengths * rle_mean_dec$values
index <- match(max(rle_true), rle_true)
outage_b <- cumsum(rle_mean_dec$lengths)[index] - max(rle_true) + window_size
t1 <- data$transactiondate[outage_a]
t2 <- data$transactiondate[outage_b]
plot(data$transactiondate, data$value)
abline(v=t1, col="red")
abline(v=t2, col="red")
4
?rle
t1
t2
library(zoo)
setwd('/home/roman/Documents/Projects/Socure/ProgrammingTest/outage')
data <- read.csv('data.csv')
window_size <- 50
mean_value <- rollapply(data$value, width = window_size, by = 1, align="left", FUN = mean)
# find point when mean values increase:
mean_increase <- diff(mean_value) > 0
rle_mean_inc <- rle(mean_increase)
rle_true <- rle_mean_inc$lengths * rle_mean_inc$values
index_rle <- match(max(rle_true), rle_true)
outage_a <- cumsum(rle_mean_inc$lengths)[index_rle] - max(rle_true) + window_size
# find point when mean values decrease:
mean_decrease <- diff(a) < 0
rle_mean_dec <- rle(mean_decrease)
rle_true <- rle_mean_dec$lengths * rle_mean_dec$values
index_rle <- match(max(rle_true), rle_true)
outage_b <- cumsum(rle_mean_dec$lengths)[index_rle] - max(rle_true) + window_size
outage_start <- min(outage_a, outage_b)
outage_end <- max(outage_a, outage_b)
(start_outage <- data$transactiondate[outage_a])
(end_outage <- data$transactiondate[outage_b])
plot(data$transactiondate, data$value)
abline(v = start_outage, col = "red")
abline(v = end_outage, col = "red")
plot(data$transactiondate, data$value, main="Outage recognition", ylab="Probability score")
abline(v=start_outage, col="red")
abline(v=end_outage, col="red")
